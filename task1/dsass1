EMPCROSS <- CROSS EMPLOYEE EMPLOYEE
NEWT <- SELECT EMPLOYEE1_Super_ssn == EMPLOYEE2_Ssn FROM EMPCROSS
FIN <- SELECT EMPLOYEE1_Dno != EMPLOYEE2_Dno FROM NEWT 
RENAME EMPLOYEE1_Ssn TO Ssn FROM FIN
RENAME EMPLOYEE1_Dno TO Dno FROM FIN
RENAME EMPLOYEE2_Ssn TO Super_ssn FROM FIN
RENAME EMPLOYEE2_Dno TO Super_dno FROM FIN
Q1 <- PROJECT Ssn,Dno,Super_ssn,Super_dno FROM FIN
EXPORT Q1

EMPWORK <- CROSS EMPLOYEE WORKS_ON
EMPWRK <- SELECT Ssn == Essn FROM EMPWORK
CMP <- CROSS EMPWRK PROJECT
TMP1 <- SELECT Pno == Pnumber FROM CMP
TMP2 <- SELECT Dno == Dnum FROM TMP1
RENAME Dnum TO P_dno FROM TMP2
Q2 <- PROJECT Ssn,Dno,Pno,P_dno FROM TMP2
EXPORT Q2


TMP3 <- SELECT Dno != Dnum FROM TMP1
RENAME Dnum TO P_dno FROM TMP3
Q3 <- PROJECT Ssn,Dno,Pno,P_dno FROM TMP3
EXPORT Q3

AGETAB <- SELECT EMPLOYEE1_Bdate < EMPLOYEE2_Bdate FROM NEWT 
RENAME EMPLOYEE1_Ssn TO Essn FROM AGETAB
RENAME EMPLOYEE1_Bdate TO E_bdate FROM AGETAB
RENAME EMPLOYEE2_Ssn TO Super_ssn FROM AGETAB
RENAME EMPLOYEE2_Bdate TO Super_bdate FROM AGETAB
Q4 <- PROJECT Super_ssn,Super_bdate,Essn,E_bdate FROM AGETAB
EXPORT Q4



DEPT <- SELECT EMPLOYEE1_Dno == EMPLOYEE2_Dno FROM EMPCROSS
DEPTDIV <- SELECT EMPLOYEE1_Sex != EMPLOYEE2_Sex FROM DEPT
RENAME EMPLOYEE1_Dno TO Dno FROM DEPTDIV
Q5 <- PROJECT Dno FROM DEPTDIV
EXPORT Q5
